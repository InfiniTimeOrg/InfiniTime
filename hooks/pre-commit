#!/bin/sh

changedFiles="$(git clang-format --extensions cpp,h --style file --staged -q --diffstat -- ':!src/FreeRTOS' ':!src/libs')"
git clang-format --extensions cpp,h --style file --staged -q -- ':!src/FreeRTOS' ':!src/libs'

echo "$changedFiles" | head -n -1 | cut -d ' ' -f 1 | while read -r file; do
  git add -- "$file"
done
