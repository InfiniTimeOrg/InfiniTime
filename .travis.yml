language: c
os: linux
name: "ARM GCC"

before_install:
  # Save path to the git respository
  - PROJECT_PATH=$(pwd)
  #- mkdir $PROJECT_PATH/build
install:
  # Install toolchain in opt folder
  - cd /opt
  - wget https://developer.arm.com/-/media/Files/downloads/gnu-rm/9-2019q4/gcc-arm-none-eabi-9-2019-q4-major-x86_64-linux.tar.bz2
  - tar -xvf gcc-arm-none-eabi-9-2019-q4-major-x86_64-linux.tar.bz2
  - export PATH=/opt/gcc-arm-none-eabi-9-2019-q4-major/arm-none-eabi/bin/:$PATH
  # install SDK in opt folder
  - mkdir sdk
  - cd sdk
  - wget https://www.nordicsemi.com/-/media/Software-and-other-downloads/SDKs/nRF5/Binaries/nRF5SDK160098a08e2.zip
  - unzip nRF5SDK160098a08e2.zip

script:
  - arm-none-eabi-gcc --version
  - cd $PROJECT_PATH #/build
  #cmake configure
  - cmake -DARM_NONE_EABI_TOOLCHAIN_PATH=/opt/gcc-arm-none-eabi-9-2019-q4-major -DNRF5_SDK_PATH=/opt/sdk/ -DUSE_OPENOCD=1 "-DTOOLCHAIN_PREFIX=opt/gcc-arm-none-eabi-9-2019-q4-major"
  #build
  - make pinetime-app
